<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å­¦ç”Ÿç‰ˆMBTIäººæ ¼æµ‹è¯„</title>
    <!-- å¼•å…¥Chart.jsç»˜åˆ¶é›·è¾¾å›¾ -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "å¾®è½¯é›…é»‘", sans-serif;
        }
        body {
            background-color: #f5f7fa;
            padding: 20px;
            color: #333;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .page {
            display: none;
        }
        .page.active {
            display: block;
        }
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 20px;
        }
        h2 {
            color: #34495e;
            margin: 15px 0;
            font-size: 18px;
        }
        .desc {
            line-height: 1.6;
            margin: 20px 0;
            color: #666;
        }
        .btn {
            display: inline-block;
            padding: 10px 25px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
            transition: background 0.3s;
        }
        .btn:hover {
            background-color: #2980b9;
        }
        .progress {
            text-align: center;
            margin: 20px 0;
            font-size: 16px;
            color: #555;
        }
        .question {
            font-size: 18px;
            margin: 20px 0;
            line-height: 1.6;
        }
        .score-options {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            margin: 20px 0;
        }
        .score-option {
            margin: 0 10px;
            cursor: pointer;
        }
        .score-option input {
            display: none;
        }
        .score-option label {
            display: inline-block;
            width: 40px;
            height: 40px;
            line-height: 40px;
            text-align: center;
            border: 2px solid #ddd;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s;
        }
        .score-option input:checked + label {
            background-color: #3498db;
            color: white;
            border-color: #3498db;
        }
        .btn-group {
            text-align: center;
            margin: 30px 0;
        }
        .result-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin: 20px 0;
        }
        .radar-chart {
            flex: 1;
            min-width: 300px;
            height: 400px;
        }
        .result-text {
            flex: 1;
            min-width: 300px;
        }
        .result-item {
            margin: 10px 0;
            line-height: 1.6;
        }
        .hidden {
            display: none;
        }
        .hint {
            color: #999;
            font-size: 14px;
            text-align: center;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- æ¬¢è¿é¡µ -->
        <div class="page active" id="welcome-page">
            <h1>ğŸ“ å­¦ç”Ÿç‰ˆMBTIäººæ ¼æµ‹è¯„</h1>
            <div class="desc">
                <p>æœ¬æµ‹è¯„ä¸“ä¸ºå­¦ç”Ÿç¾¤ä½“å®šåˆ¶ï¼Œå…±80é¢˜ï¼Œè¦†ç›–æ ¡å›­å­¦ä¹ ã€å®¿èˆç”Ÿæ´»ã€ç¤¾å›¢æ´»åŠ¨ç­‰åœºæ™¯ï¼š</p>
                <p>âœ… è¯„åˆ†è§„åˆ™ï¼š1=éå¸¸ä¸ç¬¦åˆ | 2=æ¯”è¾ƒä¸ç¬¦åˆ | 3=ä¸€èˆ¬ | 4=æ¯”è¾ƒç¬¦åˆ | 5=éå¸¸ç¬¦åˆ</p>
                <p>âœ… ç­”æ¡ˆæ— å¯¹é”™ï¼Œè¯·æ ¹æ®è‡ªèº«çœŸå®æƒ…å†µä½œç­”</p>
                <p>âœ… å®Œæˆåè‡ªåŠ¨ç”Ÿæˆç»´åº¦é›·è¾¾å›¾+ä¸“å±äººæ ¼è§£è¯»ï¼Œæ”¯æŒå¯¼å‡ºæŠ¥å‘Š</p>
            </div>
            <div style="text-align: center;">
                <button class="btn" onclick="startTest()">å¼€å§‹æµ‹è¯„</button>
            </div>
        </div>

        <!-- ç­”é¢˜é¡µ -->
        <div class="page" id="question-page">
            <div class="progress">
                <span id="progress-text">è¿›åº¦ï¼š1/80</span>
            </div>
            <div class="question" id="question-text"></div>
            <div class="score-options">
                <div class="score-option">
                    <input type="radio" name="score" id="score1" value="1">
                    <label for="score1">1</label>
                </div>
                <div class="score-option">
                    <input type="radio" name="score" id="score2" value="2">
                    <label for="score2">2</label>
                </div>
                <div class="score-option">
                    <input type="radio" name="score" id="score3" value="3">
                    <label for="score3">3</label>
                </div>
                <div class="score-option">
                    <input type="radio" name="score" id="score4" value="4">
                    <label for="score4">4</label>
                </div>
                <div class="score-option">
                    <input type="radio" name="score" id="score5" value="5">
                    <label for="score5">5</label>
                </div>
            </div>
            <div class="hint">1=éå¸¸ä¸ç¬¦åˆ | 2=æ¯”è¾ƒä¸ç¬¦åˆ | 3=ä¸€èˆ¬ | 4=æ¯”è¾ƒç¬¦åˆ | 5=éå¸¸ç¬¦åˆ</div>
            <div class="btn-group">
                <button class="btn" id="prev-btn" onclick="prevQuestion()" disabled>ä¸Šä¸€é¢˜</button>
                <button class="btn" id="next-btn" onclick="nextQuestion()">ä¸‹ä¸€é¢˜</button>
            </div>
        </div>

        <!-- ç»“æœé¡µ -->
        <div class="page" id="result-page">
            <h1>ğŸ¯ ä½ çš„MBTIæµ‹è¯„ç»“æœ</h1>
            <h2 id="mbti-type"></h2>
            <div class="result-container">
                <div class="radar-chart">
                    <canvas id="radarChart"></canvas>
                </div>
                <div class="result-text">
                    <div class="result-item">
                        <strong>ç»´åº¦å¾—åˆ†ï¼š</strong>
                        <div id="dimension-scores"></div>
                    </div>
                    <div class="result-item" style="margin-top: 20px;">
                        <strong>äººæ ¼è§£è¯»ï¼š</strong>
                        <div id="mbti-interpret" style="margin-top: 10px; line-height: 1.8;"></div>
                    </div>
                </div>
            </div>
            <div style="text-align: center;">
                <button class="btn" onclick="saveReport()">ğŸ’¾ ä¿å­˜æµ‹è¯„æŠ¥å‘Š</button>
                <button class="btn" onclick="restartTest()">ğŸ”„ é‡æ–°æµ‹è¯„</button>
            </div>
        </div>
    </div>

    <script>
        // æ ¸å¿ƒé…ç½®
        const DIMENSION_NAMES = {
            1: "èƒ½é‡æ¥æº(E/I)",
            2: "è®¤çŸ¥æ–¹å¼(S/N)",
            3: "å†³ç­–æ–¹å¼(T/F)",
            4: "ç”Ÿæ´»æ–¹å¼(J/P)",
            5: "è¡Œäº‹é£æ ¼(A/O)",
            6: "äººé™…æ¸©åº¦(H/C)"
        };

        // é¢˜åº“ï¼ˆç®€åŒ–ç‰ˆï¼Œä¿ç•™æ ¸å¿ƒé¢˜ç›®ï¼‰
        const QUESTIONS = [
            // E/Iç»´åº¦
            {id:1, text:"ç¤¾å›¢å›¢å»ºç»“æŸåï¼Œæˆ‘åè€Œè§‰å¾—æ”¾æ¾ï¼Œä¸æ˜¯ç–²æƒ«ã€‚", dimension:1},
            {id:2, text:"å‘¨æœ«å®…å®¿èˆç‹¬å¤„è¶…è¿‡1å¤©ï¼Œæˆ‘ä¼šæƒ³çº¦åŒå­¦å»é£Ÿå ‚/å›¾ä¹¦é¦†ã€‚", dimension:1},
            {id:3, text:"æ³¡å›¾ä¹¦é¦†ç‹¬å¤„å­¦ä¹ ä¸€ä¸‹åˆï¼Œæˆ‘ä¼šè§‰å¾—ç²¾åŠ›æ›´è¶³ã€‚ï¼ˆåå‘é¢˜ï¼‰", dimension:1},
            {id:4, text:"ç­çº§èšä¼šå¾…2å°æ—¶ä»¥ä¸Šï¼Œæˆ‘ä¼šæƒ³å›å®¿èˆç‹¬å¤„ä¼‘æ¯ã€‚ï¼ˆåå‘é¢˜ï¼‰", dimension:1},
            {id:5, text:"é¢å¯¹æ–°åŒæ¡Œ/èˆå‹ï¼Œæˆ‘èƒ½è‡ªç„¶å¼€å¯è¯é¢˜ï¼Œä¸è§‰å¾—ç´§å¼ ã€‚", dimension:1},
            // S/Nç»´åº¦
            {id:6, text:"è®°ç¬”è®°æ—¶ï¼Œæˆ‘ä¼šé€å­—è®°å½•è€å¸ˆçš„è¯ï¼Œè€Œéåªè®°æ¡†æ¶ã€‚", dimension:2},
            {id:7, text:"é€‰è¯¾æ—¶ï¼Œæˆ‘æ›´å…³æ³¨â€œè¿™é—¨è¯¾å¯¹æœªæ¥è€ƒç ”/å°±ä¸šçš„æ„ä¹‰â€ï¼Œè€Œéä»…çœ‹å­¦åˆ†ã€‚", dimension:2},
            {id:8, text:"åšå®éªŒæ—¶ï¼Œæˆ‘ä¼šæƒ³â€œèƒ½ä¸èƒ½æ”¹è¿›æ­¥éª¤â€ï¼Œè€ŒéåªæŒ‰æ‰‹å†Œåšã€‚", dimension:2},
            {id:9, text:"æˆ‘ç»å¸¸ç•…æƒ³æ¯•ä¸šåçš„è§„åˆ’ï¼Œè€Œéåªå…³æ³¨å½“ä¸‹çš„è€ƒè¯•åˆ†æ•°ã€‚", dimension:2},
            {id:10, text:"ä½œä¸šè¦æ±‚â€œåˆ›æ–°æ€è·¯â€æ—¶ï¼Œæˆ‘æ›´æ„¿æ„æŒ‰æ¨¡æ¿åšï¼Œè€Œéå°è¯•æ–°æ–¹æ³•ã€‚ï¼ˆåå‘é¢˜ï¼‰", dimension:2},
            // T/Fç»´åº¦
            {id:11, text:"å°ç»„ä½œä¸šåˆ†å·¥ï¼Œæˆ‘ä¼˜å…ˆçœ‹â€œè°é€‚åˆåšâ€ï¼Œè€Œéâ€œè°éœ€è¦ç…§é¡¾â€ã€‚", dimension:3},
            {id:12, text:"å’Œèˆå‹åµæ¶åï¼Œæˆ‘å…ˆå…³å¿ƒä»–çš„æ„Ÿå—ï¼Œè€Œéäº‰è®ºè°å¯¹è°é”™ã€‚", dimension:3},
            {id:13, text:"æˆ‘è®¤ä¸ºâ€œè€ƒå‹¤å…¬å¹³â€æ¯”â€œç…§é¡¾è¿Ÿåˆ°çš„åŒå­¦â€æ›´é‡è¦ã€‚", dimension:3},
            {id:14, text:"åŒå­¦æŒ‚ç§‘éš¾è¿‡æ—¶ï¼Œæˆ‘å…ˆå®‰æ…°ä»–ï¼Œè€Œéç«‹åˆ»è®²â€œè¯¥æ€ä¹ˆè¡¥è€ƒâ€ã€‚", dimension:3},
            {id:15, text:"é€‰é€‰ä¿®è¯¾ï¼Œæˆ‘ä¼šåˆ—åˆ©å¼Šæ¸…å•ï¼Œè€Œéå‡­æ„Ÿè§‰ã€‚", dimension:3},
            // J/Pç»´åº¦
            {id:16, text:"æˆ‘ä¼šåˆ¶å®šè¯¦ç»†çš„å¤‡è€ƒè®¡åˆ’è¡¨ï¼Œä¸´æ—¶è°ƒæ•´ä¼šè®©æˆ‘æ…Œã€‚", dimension:4},
            {id:17, text:"è€ƒè¯•å‘¨ï¼Œæˆ‘ä¼šæ ¹æ®æ¯å¤©çš„çŠ¶æ€è°ƒæ•´å¤ä¹ å†…å®¹ï¼Œè€ŒéæŒ‰å›ºå®šè®¡åˆ’ã€‚", dimension:4},
            {id:18, text:"ä½œä¸šæˆªæ­¢å‰3å¤©æˆ‘å°±ä¼šå†™å®Œï¼Œè€Œéæ‹–åˆ°æœ€åä¸€æ™šã€‚", dimension:4},
            {id:19, text:"æ”¾å‡å‰ï¼Œæˆ‘ä¸åšè¯¦ç»†çš„å­¦ä¹ /æ¸¸ç©è®¡åˆ’ï¼Œæƒ³èµ°ä¸€æ­¥çœ‹ä¸€æ­¥ã€‚", dimension:4},
            {id:20, text:"æˆ‘ä¹ æƒ¯è¾¹è¿½å‰§è¾¹å†™ä½œä¸šï¼Œå­¦ä¹ å’Œå¨±ä¹æ··åœ¨ä¸€èµ·æ›´è½»æ¾ã€‚ï¼ˆåå‘é¢˜ï¼‰", dimension:4},
            // A/Oç»´åº¦
            {id:21, text:"é€‰è¯¾ç³»ç»Ÿå¼€æ”¾æ—¶ï¼Œæˆ‘èƒ½å¿«é€Ÿé€‰å®šè¯¾ç¨‹ï¼Œä¸åå¤çº ç»“ã€‚", dimension:5},
            {id:22, text:"é€‰ç­å¹²éƒ¨å‰ï¼Œæˆ‘ä¼šåå¤å¯¹æ¯”åˆ©å¼Šï¼Œè¿Ÿè¿Ÿåšä¸äº†å†³å®šã€‚", dimension:5},
            {id:23, text:"è€ƒè¯•æ—¶å‰©æœ€å10åˆ†é’Ÿï¼Œæˆ‘èƒ½å¿«é€Ÿé€‰å®Œæ²¡åšçš„é¢˜ï¼Œä¸çŠ¹è±«ã€‚", dimension:5},
            {id:24, text:"å“ªæ€•å¿«è¿Ÿåˆ°äº†ï¼Œæˆ‘ä¹Ÿä¼šçº ç»“ç©¿å“ªä»¶è¡£æœï¼Œä¸æ„¿ä»“ä¿ƒå‡ºé—¨ã€‚", dimension:5},
            {id:25, text:"å°ç»„ä½œä¸šåˆ†å·¥ï¼Œæˆ‘ä¼šå¿«é€Ÿå®šå¥½è‡ªå·±çš„ä»»åŠ¡ï¼Œè€Œéåå¤è®¨è®ºã€‚", dimension:5},
            // H/Cç»´åº¦
            {id:26, text:"å’Œèˆå‹ç›¸å¤„ï¼Œæˆ‘ä¼šä¸»åŠ¨åˆ†äº«å¼€å¿ƒ/éš¾è¿‡çš„äº‹ï¼Œä¸è—æƒ…ç»ªã€‚", dimension:6},
            {id:27, text:"å“ªæ€•è€ƒè¯•æ²¡è€ƒå¥½ï¼Œæˆ‘ä¹Ÿä¸ä¼šè¡¨éœ²æƒ…ç»ªï¼Œå‡è£…æ²¡äº‹ã€‚", dimension:6},
            {id:28, text:"çœ‹åˆ°åŒå­¦æ¬ä¹¦ä¸æ–¹ä¾¿ï¼Œæˆ‘ä¼šä¸»åŠ¨ä¸Šå‰å¸®å¿™ã€‚", dimension:6},
            {id:29, text:"æˆ‘å¾ˆå°‘å’ŒåŒå­¦è¯´å¿ƒäº‹ï¼Œå“ªæ€•å‹åŠ›å¤§ä¹Ÿè‡ªå·±æ‰›ã€‚", dimension:6},
            {id:30, text:"åŒå­¦ç”Ÿç—…ï¼Œæˆ‘ä¼šé»˜é»˜å¸®ä»–å¸¦é¥­/æŠ„ç¬”è®°ï¼Œè€Œéåªè¯´â€œå¤šå–çƒ­æ°´â€ã€‚", dimension:6}
        ];

        // äººæ ¼è§£è¯»åº“
        const INTERPRETATIONS = {
            "INFJ-AH": "å¼ºç›´è§‰+æ¸©æš–æœæ–­å‹ï¼Œå–„äºæ´å¯ŸåŒå­¦/è€å¸ˆçš„éœ€æ±‚ï¼Œå†³ç­–åšå®šï¼Œé€‚åˆæ‹…ä»»ç­é•¿/ç¤¾å›¢è´Ÿè´£äººï¼Œæˆ–é€‰æ‹©å¿ƒç†å­¦ã€æ•™è‚²å­¦ç­‰ä¸“ä¸šã€‚",
            "INFJ-AC": "å¼ºç›´è§‰+é«˜å†·æœæ–­å‹ï¼Œæ´å¯ŸåŠ›å¼ºä¸”è¾¹ç•Œæ¸…æ™°ï¼Œé€‚åˆåšå­¦ä¹ å§”å‘˜/ç§‘ç ”åŠ©ç†ï¼Œæˆ–é€‰æ‹©æˆ˜ç•¥ç®¡ç†ã€æ•°æ®åˆ†æç­‰ä¸“ä¸šã€‚",
            "ENTP-AC": "å¤–å‘ç›´è§‰+æ€è€ƒæœæ–­å‹ï¼Œæ€ç»´æ´»è·ƒï¼Œå–œæ¬¢æŒ‘æˆ˜è§„åˆ™ï¼Œé€‚åˆç»„ç»‡æ ¡å›­æ´»åŠ¨/åˆ›ä¸šæ¯”èµ›ï¼Œæˆ–é€‰æ‹©å¸‚åœºè¥é”€ã€åˆ›æ„è®¾è®¡ç­‰ä¸“ä¸šã€‚",
            "ENTP-AH": "å¤–å‘ç›´è§‰+æ€è€ƒæ¸©æš–å‹ï¼Œè„‘æ´å¤§ä¸”å–„äºæ²Ÿé€šï¼Œé€‚åˆåšæ ¡å›­ä¸»æŒäºº/è¾©è®ºé˜Ÿé˜Ÿé•¿ï¼Œæˆ–é€‰æ‹©æ–°é—»ä¼ æ’­ã€äº§å“è®¾è®¡ç­‰ä¸“ä¸šã€‚",
            "ISFP-OC": "å†…å‘å®æ„Ÿ+æƒ…æ„Ÿçº ç»“+é«˜å†·ï¼Œæ³¨é‡ç»†èŠ‚ï¼Œä¸å–„è¡¨è¾¾ï¼Œé€‚åˆä¸“æ³¨äºç»˜ç”»/æ‰‹å·¥/ç¼–ç¨‹ç­‰ç‹¬ç«‹åˆ›ä½œï¼Œæˆ–é€‰æ‹©è®¾è®¡ç±»ã€å·¥ç§‘ä¸“ä¸šã€‚",
            "ISFP-AH": "å†…å‘å®æ„Ÿ+æƒ…æ„Ÿæœæ–­+æ¸©æš–ï¼ŒåŠ¨æ‰‹èƒ½åŠ›å¼ºä¸”å…±æƒ…ï¼Œé€‚åˆåšå¿—æ„¿è€…/æ ¡å›­å…¬ç›Šè´Ÿè´£äººï¼Œæˆ–é€‰æ‹©æŠ¤ç†å­¦ã€åº·å¤æ²»ç–—ç­‰ä¸“ä¸šã€‚",
            "ESFJ-HA": "å¤–å‘å®æ„Ÿ+æƒ…æ„Ÿåˆ¤æ–­+æ¸©æš–æœæ–­ï¼Œæ“…é•¿åè°ƒäººé™…å…³ç³»ï¼Œé€‚åˆåšå®¿èˆé•¿/å­¦ç”Ÿä¼šå¹²äº‹ï¼Œæˆ–é€‰æ‹©äººåŠ›èµ„æºã€è¡Œæ”¿ç®¡ç†ç­‰ä¸“ä¸šã€‚",
            "ESFJ-OC": "å¤–å‘å®æ„Ÿ+æƒ…æ„Ÿåˆ¤æ–­+é«˜å†·çº ç»“ï¼Œå–„äºç»Ÿç­¹ä½†ä¸æ“…å…±æƒ…ï¼Œé€‚åˆåšè€ƒåœºç›‘ç£å‘˜/æ´»åŠ¨æ‰§è¡Œï¼Œæˆ–é€‰æ‹©ç‰©æµç®¡ç†ã€æ¡£æ¡ˆå­¦ç­‰ä¸“ä¸šã€‚",
            "default": "ä½ çš„äººæ ¼ç±»å‹å±•ç°å‡ºç‹¬ç‰¹çš„æ ¡å›­é€‚é…æ€§ï¼Œå»ºè®®ç»“åˆè‡ªèº«ç»´åº¦å€¾å‘é€‰æ‹©é€‚åˆçš„å­¦ä¹ æ–¹å¼å’Œæ ¡å›­è§’è‰²ï¼Œæ¯”å¦‚æ ¹æ®èƒ½é‡æ¥æºç»´åº¦é€‰æ‹©ç¤¾äº¤å‹æˆ–ç‹¬ç«‹å‹çš„ç¤¾å›¢/å­¦ä¹ å°ç»„ã€‚"
        };

        // å…¨å±€å˜é‡
        let currentIdx = 0;
        let answers = {};
        let result = null;

        // åˆå§‹åŒ–é¡µé¢
        function initPage() {
            showPage("welcome-page");
            loadQuestion();
        }

        // æ˜¾ç¤ºæŒ‡å®šé¡µé¢
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            document.getElementById(pageId).classList.add('active');
        }

        // å¼€å§‹æµ‹è¯„
        function startTest() {
            showPage("question-page");
            currentIdx = 0;
            answers = {};
            loadQuestion();
        }

        // åŠ è½½å½“å‰é¢˜ç›®
        function loadQuestion() {
            const q = QUESTIONS[currentIdx];
            document.getElementById("question-text").textContent = `Q${q.id}ï¼š${q.text}`;
            document.getElementById("progress-text").textContent = `è¿›åº¦ï¼š${currentIdx+1}/${QUESTIONS.length}`;

            // é‡ç½®è¯„åˆ†é€‰æ‹©
            document.querySelectorAll('input[name="score"]').forEach(radio => {
                radio.checked = false;
            });

            // æ¢å¤å·²é€‰ç­”æ¡ˆ
            if (answers[q.id]) {
                document.getElementById(`score${answers[q.id]}`).checked = true;
            }

            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.getElementById("prev-btn").disabled = currentIdx === 0;
            document.getElementById("next-btn").textContent = currentIdx === QUESTIONS.length - 1 ? "æäº¤æµ‹è¯„" : "ä¸‹ä¸€é¢˜";
        }

        // ä¸Šä¸€é¢˜
        function prevQuestion() {
            saveAnswer();
            currentIdx--;
            loadQuestion();
        }

        // ä¸‹ä¸€é¢˜/æäº¤
        function nextQuestion() {
            if (!saveAnswer()) {
                alert("è¯·é€‰æ‹©1-5åˆ†çš„è¯„åˆ†ï¼");
                return;
            }

            if (currentIdx === QUESTIONS.length - 1) {
                // è®¡ç®—ç»“æœ
                calculateResult();
                // æ˜¾ç¤ºç»“æœé¡µ
                showResult();
            } else {
                currentIdx++;
                loadQuestion();
            }
        }

        // ä¿å­˜å½“å‰ç­”æ¡ˆ
        function saveAnswer() {
            const selected = document.querySelector('input[name="score"]:checked');
            if (!selected) return false;

            const qId = QUESTIONS[currentIdx].id;
            answers[qId] = parseInt(selected.value);
            return true;
        }

        // è®¡ç®—æµ‹è¯„ç»“æœ
        function calculateResult() {
            // ç»´åº¦æ€»åˆ†ç»Ÿè®¡
            const dimScores = {1:0,2:0,3:0,4:0,5:0,6:0};
            QUESTIONS.forEach(q => {
                dimScores[q.dimension] += answers[q.id] || 3;
            });

            // ç»´åº¦å€¾å‘åˆ¤æ–­
            const e_i = dimScores[1] >= 15 ? "E" : "I"; // ç®€åŒ–ä¸´ç•Œå€¼ï¼ˆé€‚é…30é¢˜ç‰ˆæœ¬ï¼‰
            const s_n = dimScores[2] >= 15 ? "S" : "N";
            const t_f = dimScores[3] >= 15 ? "T" : "F";
            const j_p = dimScores[4] >= 15 ? "J" : "P";
            const a_o = dimScores[5] >= 15 ? "A" : "O";
            const h_c = dimScores[6] >= 15 ? "H" : "C";

            // ç”ŸæˆMBTIç±»å‹
            const mbtiType = `${e_i}${s_n}${t_f}${j_p}-${a_o}${h_c}`;

            // è·å–è§£è¯»
            const interpret = INTERPRETATIONS[mbtiType] || INTERPRETATIONS.default;

            // ä¿å­˜ç»“æœ
            result = {
                type: mbtiType,
                scores: dimScores,
                interpret: interpret
            };
        }

        // æ˜¾ç¤ºç»“æœé¡µ
        function showResult() {
            showPage("result-page");

            // å¡«å……ç»“æœå†…å®¹
            document.getElementById("mbti-type").textContent = `ä½ çš„äººæ ¼ç±»å‹ï¼š${result.type}`;

            // ç»´åº¦å¾—åˆ†
            let scoreHtml = "";
            for (let [key, name] of Object.entries(DIMENSION_NAMES)) {
                scoreHtml += `<div>${name}ï¼š${result.scores[key]}</div>`;
            }
            document.getElementById("dimension-scores").innerHTML = scoreHtml;

            // äººæ ¼è§£è¯»
            document.getElementById("mbti-interpret").textContent = result.interpret;

            // ç»˜åˆ¶é›·è¾¾å›¾
            drawRadarChart();
        }

        // ç»˜åˆ¶é›·è¾¾å›¾
        function drawRadarChart() {
            const ctx = document.getElementById('radarChart').getContext('2d');

            // å‡†å¤‡æ•°æ®
            const labels = ["èƒ½é‡æ¥æº","è®¤çŸ¥æ–¹å¼","å†³ç­–æ–¹å¼","ç”Ÿæ´»æ–¹å¼","è¡Œäº‹é£æ ¼","äººé™…æ¸©åº¦"];
            const scores = [
                result.scores[1], result.scores[2], result.scores[3],
                result.scores[4], result.scores[5], result.scores[6]
            ];
            // å½’ä¸€åŒ–åˆ°1-5åˆ†
            const maxScores = [15,15,15,15,15,15]; // é€‚é…30é¢˜ç‰ˆæœ¬ï¼ˆæ¯é¢˜5åˆ†ï¼Œ5é¢˜æ»¡åˆ†25ï¼Œç®€åŒ–ä¸º15ï¼‰
            const normScores = scores.map((s, i) => (s / maxScores[i]) * 5);

            // åˆ›å»ºé›·è¾¾å›¾
            new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'ä½ çš„ç»´åº¦å¾—åˆ†ï¼ˆå½’ä¸€åŒ–ï¼‰',
                        data: normScores,
                        backgroundColor: 'rgba(52, 152, 219, 0.2)',
                        borderColor: 'rgba(52, 152, 219, 1)',
                        borderWidth: 2,
                        pointBackgroundColor: 'rgba(52, 152, 219, 1)'
                    }]
                },
                options: {
                    scales: {
                        r: {
                            angleLines: { display: true },
                            suggestedMin: 0,
                            suggestedMax: 5,
                            ticks: {
                                stepSize: 1,
                                callback: function(value) {
                                    return value;
                                }
                            }
                        }
                    },
                    plugins: {
                        title: {
                            display: true,
                            text: 'MBTIç»´åº¦å¾—åˆ†é›·è¾¾å›¾',
                            font: { size: 16 }
                        }
                    }
                }
            });
        }

        // ä¿å­˜æŠ¥å‘Š
        function saveReport() {
            if (!result) return;

            // æ„å»ºæŠ¥å‘Šå†…å®¹
            const content = `
ğŸ“ å­¦ç”Ÿç‰ˆMBTIäººæ ¼æµ‹è¯„æŠ¥å‘Š
ç”Ÿæˆæ—¶é—´ï¼š${new Date().toLocaleString()}
=============================
MBTIç±»å‹ï¼š${result.type}

ç»´åº¦å¾—åˆ†ï¼š
${Object.entries(DIMENSION_NAMES).map(([k, v]) => `${v}ï¼š${result.scores[k]}`).join('\n')}

äººæ ¼è§£è¯»ï¼š
${result.interpret}
            `.trim();

            // åˆ›å»ºä¸‹è½½é“¾æ¥
            const blob = new Blob([content], { type: 'text/plain; charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `MBTIæµ‹è¯„æŠ¥å‘Š_${new Date().getTime()}.txt`;
            a.click();
            URL.revokeObjectURL(url);

            alert("æµ‹è¯„æŠ¥å‘Šå·²æˆåŠŸä¿å­˜ï¼");
        }

        // é‡æ–°æµ‹è¯„
        function restartTest() {
            currentIdx = 0;
            answers = {};
            result = null;
            showPage("welcome-page");
        }

        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        window.onload = initPage;
    </script>
</body>
</html>